<!DOCTYPE html>
<!-- saved from url=(0039)https://walter0807.github.io/Social-CH/ -->
<html><head lang="en"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>Language Models Represent Beliefs of Self and Others</title>

    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="./assets/bootstrap.min.css">
    <link rel="stylesheet" href="./assets/font-awesome.min.css">
    <link rel="stylesheet" href="./assets/codemirror.min.css">
    <link rel="stylesheet" href="./assets/app.css">

    <link rel="stylesheet" href="./assets/bootstrap(1).min.css">

    <script src="./assets/jquery.min.js"></script>
    <script src="./assets/bootstrap.min.js"></script>
    <script src="./assets/codemirror.min.js"></script>
    <script src="./assets/clipboard.min.js"></script>

    <script src="./assets/app.js"></script>
    <link href="./assets/css" rel="stylesheet">
    <style> 
        span {
          font-family: Courier;
        }
        p {
            font-size: 17px;
        }
        .nav-pills a:hover {
            text-decoration: none;
        }
      .card {
    margin: 30px auto; /* 上下各30px的外边距，左右自动调整使其居中 */
    display: block; /* 确保div作为块级元素处理 */
    text-align: center; /* 使内部的内容（如图片）居中显示 */
  }
  .card img {
    width: 50%; /* 图片宽度为原始大小的50% */
    border-radius: 10px; /* 图片的圆角边缘 */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* 图片的阴影效果 */
    display: inline-block; /* 图片作为内联块级元素显示，以便它们可以被文本对齐属性影响 */
  }
    </style>
</head>



<body>
    <div class="container" id="main">
        <div class="row">
            <h2 class="col-md-12 text-center">
                <b>Language Models Represent Beliefs of Self and Others</b>
                <!-- <small> -->
                            </h2>
           <!--          <h2 class="col-md-12 text-center">
                        NeurIPS 2023
                                </h2> -->
                <!-- </small> -->
            
        </div>
        <br>
        <div class="row">
            <div class="col-md-12 text-center" style="font-size: 24px">
                <ul class="list-inline" style="font-size: 20px; color: black">
                    <li>
                        <a href="https://walter0807.github.io/" ,="" target="_blank" style="font-size: 22px; color: black">Wentao Zhu</a>
                    </li>
                    <li>
                        <a href="https://github.com/zzn-nzz" ,="" target="_blank" style="font-size: 22px; color: black">Zhining Zhang</a>
                    </li>
                    <li>
                        <a href="https://cfcs.pku.edu.cn/english/people/faculty/yizhouwang/index.htm" ,="" target="_blank" style="font-size: 22px; color: black">Yizhou Wang</a>
                    </li>
                </ul>
                <br>
                <p style="font-size: 22px">
                    Peking University
                </p>
            </div>
        </div>

        <br>
    
<p align="center">
<a href="https://arxiv.org/", target="_blank">
<img src="assets/buttons_paper.png"alt="arXiv" style="width: 140px;"></a>
<a href="https://github.com/Walter0807/RepBelief", target="_blank">
<img src="assets/buttons_code.png" alt="GitHub" style="width: 140px;"></a>
</p>

<div class="col-md-8 col-md-offset-2 ">
    <div class="card">
    <p align="center">
      <img src="assets/teaser.jpg" style="width: 50%;">
    </p>
    </div>

    <p style="text-align:center;font-size:18px;">
      <b>TL;DR:</b> LLMs internally represent beliefs of themselves and other agents, and manipulating these representations can significantly impact their Theory of Mind reasoning capabilities.
    </p>
</div>

        <div class="row ">
            <div class="col-md-8 col-md-offset-2 ">
                <h3>
                    <b>Abstract</b>
                </h3>
                <p class="text-justify">
                    Understanding and attributing mental states, known as Theory of Mind (ToM), emerges as a fundamental capability for human social reasoning. While Large Language Models (LLMs) demonstrate certain ToM abilities, the mechanisms underlying these capabilities remain elusive. In this study, we discover that it is possible to linearly decode the belief status from the perspectives of various agents through neural activations of language models, indicating the existence of internal representations of self and others' beliefs. By manipulating these representations, we observe dramatic changes in the models' ToM performance, underscoring their pivotal role in the social reasoning process. Additionally, our findings extend to diverse social reasoning tasks that involve different causal inference patterns, suggesting the potential generalizability of these representations.
                </p>
            </div>
        </div>

<div class="row ">
            <div class="col-md-8 col-md-offset-2 ">
                <h3>
                    <b>Discovering the Belief Representations</b>
                </h3>

                <p align="center">
                  <img src="assets/probe_prompt.jpg" style="width: 100%;">
                </p>
                <p>
We prompt the model with pairs of story and belief, and use the attention head activations to decode the belief status of different agents. We focus on two agents, namely <i>protagonist</i>, the central figure of the narrative, and <i>oracle</i>, which represents an omniscient spectator's perspective.
                </p>


                <p align="center">
                  <img src="assets/probe_heads.jpg" style="width: 100%;">
                </p>
<p>
We find that even with models as simple as linear regression, it is possible to decode the belief status of both agents, either separately or jointly, from a specific group of attention heads. Notably, there exist more activation heads that could represent the oracle belief than those representing the protagonist's belief."
</p>
            </div>

            <div class="col-md-8 col-md-offset-2 ">
                <h3>
                    <b>Belief Manipulation</b>
                </h3>

                <p align="center">
                  <img src="assets/logit_half.jpg" style="width: 100%;">
                </p>
<p>
We discover that steering head activations towards the belief directions identified through multinomial probing significantly affects the model's ToM capability, whereas manipulation in random directions results in negligible change.
</p>
            </div>

            <div class="col-md-8 col-md-offset-2 ">
                <h3>
                    <b>Deciphering the Belief Directions</b>
                </h3>

                <p align="center">
                  <img src="assets/token_map_v3.jpg" style="width: 100%;">
                </p>
<p>
Furthermore, we seek to understand which input tokens are most relevant to the identified belief directions. We project the neural activations onto the belief directions and back-propagate to the input token embedding space. Remarkably, this process precisely localizes the key causal variables within the prompt, including the protagonist's desires and initial actions, the causal event that changes the environmental states, and the protagonist’s percept status of the causal event. These elements collectively enable a comprehensive inference of both agents' beliefs. These observations may also account for the generalizability of the belief directions across different social reasoning tasks.
</p>
            </div>
</div>

<div class="row">
    <div class="col-md-10 col-md-offset-2">
        <h3>
            <b>Citation</b>
        </h3>
        <div class="form-group col-md-10 col-md-offset-0">
            <div style="font-size: 22px;">
                <textarea id="bibtex" class="form-control" readonly="" style="display: none;">
@article{zhu2024language,
  title={Language Models Represent Beliefs of Self and Others},
  author={Zhu, Wentao and Zhang, Zhining and Wang, Yizhou},
  year={2024}
}
</textarea>
</div>

</div>
</div>
</div>
    </div>



</body></html>